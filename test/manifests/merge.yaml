apiVersion: v1
kind: Service
metadata:
  name: merge-test
  annotations:
    externalip.spacebird.dev/cluster-external-ip-source: merge-test
spec:
  type: LoadBalancer
  ipFamilyPolicy: RequireDualStack
  ipFamilies:
    - IPv4
    - IPv6
  selector:
    app: merge-test
  ports:
    - port: 4313
      targetPort: 4313
---
apiVersion: externalip.spacebird.dev/v1alpha1
kind: ClusterExternalIPSource
metadata:
  name: merge-test
spec:
  ipv4:
    solvers:
      - merge:
          partialSolvers:
            - mask: "255.255.0.0"
              solver:
                ipAPI: {}
            - mask: "0.0.255.0"
              solver:
                static:
                  addresses:
                    - "10.10.10.10"
            - mask: "0.0.0.255"
              solver:
                loadBalancerIngress: {}
  ipv6:
    solvers:
      - merge:
          partialSolvers:
            - mask: "ffff:ffff:ffff:ffff::"
              solver:
                ipAPI: {}
            - mask: "::ffff:ffff:ffff:ffff"
              solver:
                loadBalancerIngress: {}
